<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.85.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Websocket | CloudWeGo</title><meta name=description content="A leading practice for building enterprise cloud native middleware!"><meta property="og:title" content="Websocket"><meta property="og:description" content="WebSocket is a type of full-duplex communication that can be performed on a single TCP connection and is located at the application layer of the OSI model. WebSocket makes data exchange between client and server easier, allowing the server to actively push data to the client. In the WebSocket API, the browser and the server only need to complete a handshake that a persistent connection can be created between the two, and two-way data transmission can be performed."><meta property="og:type" content="article"><meta property="og:url" content="https://www.cloudwego.io/docs/hertz/tutorials/basic-feature/protocol/websocket/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-09-13T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-11T13:43:08+08:00"><meta property="og:site_name" content="CloudWeGo"><meta itemprop=name content="Websocket"><meta itemprop=description content="WebSocket is a type of full-duplex communication that can be performed on a single TCP connection and is located at the application layer of the OSI model. WebSocket makes data exchange between client and server easier, allowing the server to actively push data to the client. In the WebSocket API, the browser and the server only need to complete a handshake that a persistent connection can be created between the two, and two-way data transmission can be performed."><meta itemprop=datePublished content="2022-09-13T00:00:00+00:00"><meta itemprop=dateModified content="2023-04-11T13:43:08+08:00"><meta itemprop=wordCount content="1149"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Websocket"><meta name=twitter:description content="WebSocket is a type of full-duplex communication that can be performed on a single TCP connection and is located at the application layer of the OSI model. WebSocket makes data exchange between client and server easier, allowing the server to actively push data to the client. In the WebSocket API, the browser and the server only need to complete a handshake that a persistent connection can be created between the two, and two-way data transmission can be performed."><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYWRQRLPRM')</script><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="https://hm.baidu.com/hm.js?f1808c42af827f368aa7eca3baae6d55",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script><link rel=preload href=/scss/main.min.8090891c264e3fa6623cbdac7ce42c1259703e8068886edd79eb5ec5f88cd0c9.css as=style><link href=/scss/main.min.8090891c264e3fa6623cbdac7ce42c1259703e8068886edd79eb5ec5f88cd0c9.css rel=stylesheet integrity><script src=https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYWRQRLPRM','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand-xl navbar-dark td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0 ml-auto"><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Documentation</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/kitex/>Kitex</a>
<a class=dropdown-item href=/docs/hertz/>Hertz</a>
<a class=dropdown-item href=/docs/volo/>Volo</a>
<a class=dropdown-item href=/docs/netpoll/>Netpoll</a>
<a class=dropdown-item href=/docs/cwgo/>Cwgo</a>
<a class=dropdown-item href=/docs/motore/>Motore</a>
<a class=dropdown-item href=/docs/pilota/>Pilota</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cooperation/><span>Cooperation</span></a></li><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Security</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/security/safety-bulletin/>safety-bulletin</a>
<a class=dropdown-item href=/security/vulnerability-reporting/>vulnerability-reporting</a></div></li><li class="nav-item dropdown mr-4"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/hertz/tutorials/basic-feature/protocol/websocket/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.ffbc4e552f7e4427acd2c28307a2610a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.ffbc4e552f7e4427acd2c28307a2610a.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/hertz/tutorials/basic-feature/protocol/websocket/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertz-li><input type=checkbox id=m-docshertz-check checked>
<label for=m-docshertz-check><a href=/docs/hertz/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertz><span>Hertz</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzoverview-li><input type=checkbox id=m-docshertzoverview-check checked>
<label for=m-docshertzoverview-check><a href=/docs/hertz/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzgetting-started-li><input type=checkbox id=m-docshertzgetting-started-check checked>
<label for=m-docshertzgetting-started-check><a href=/docs/hertz/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzgetting-started><span>Getting Started</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorials-li><input type=checkbox id=m-docshertztutorials-check checked>
<label for=m-docshertztutorials-check><a href=/docs/hertz/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorials><span>Tutorials</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsexample-li><input type=checkbox id=m-docshertztutorialsexample-check>
<label for=m-docshertztutorialsexample-check><a href=/docs/hertz/tutorials/example/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsexample><span>Example code</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorialsbasic-feature-li><input type=checkbox id=m-docshertztutorialsbasic-feature-check checked>
<label for=m-docshertztutorialsbasic-feature-check><a href=/docs/hertz/tutorials/basic-feature/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-feature><span>Basic Feature</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurenetwork-lib-li><input type=checkbox id=m-docshertztutorialsbasic-featurenetwork-lib-check>
<label for=m-docshertztutorialsbasic-featurenetwork-lib-check><a href=/docs/hertz/tutorials/basic-feature/network-lib/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurenetwork-lib><span>Network Lib</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureroute-li><input type=checkbox id=m-docshertztutorialsbasic-featureroute-check>
<label for=m-docshertztutorialsbasic-featureroute-check><a href=/docs/hertz/tutorials/basic-feature/route/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureroute><span>Route</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsbasic-featuremiddleware-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddleware-check>
<label for=m-docshertztutorialsbasic-featuremiddleware-check><a href=/docs/hertz/tutorials/basic-feature/middleware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-featuremiddleware><span>Middleware Overview</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecors-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecors-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecors-check><a href=/docs/hertz/tutorials/basic-feature/middleware/cors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecors><span>CORS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarerecovery-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarerecovery-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarerecovery-check><a href=/docs/hertz/tutorials/basic-feature/middleware/recovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarerecovery><span>Recovery</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-check><a href=/docs/hertz/tutorials/basic-feature/middleware/basic-auth/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth><span>Basic Auth</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarejwt-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarejwt-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarejwt-check><a href=/docs/hertz/tutorials/basic-feature/middleware/jwt/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarejwt><span>JWT</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaregzip-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaregzip-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaregzip-check><a href=/docs/hertz/tutorials/basic-feature/middleware/gzip/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaregzip><span>Gzip Compress</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarei18n-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarei18n-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarei18n-check><a href=/docs/hertz/tutorials/basic-feature/middleware/i18n/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarei18n><span>Internationalization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaresession-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaresession-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaresession-check><a href=/docs/hertz/tutorials/basic-feature/middleware/session/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaresession><span>Session Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarepprof-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarepprof-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarepprof-check><a href=/docs/hertz/tutorials/basic-feature/middleware/pprof/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarepprof><span>Pprof</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarekeyauth-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarekeyauth-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarekeyauth-check><a href=/docs/hertz/tutorials/basic-feature/middleware/keyauth/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarekeyauth><span>KeyAuth</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewareswagger-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewareswagger-check>
<label for=m-docshertztutorialsbasic-featuremiddlewareswagger-check><a href=/docs/hertz/tutorials/basic-feature/middleware/swagger/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewareswagger><span>Swagger</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarerequestid-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarerequestid-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarerequestid-check><a href=/docs/hertz/tutorials/basic-feature/middleware/requestid/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarerequestid><span>Request ID</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewareaccess-log-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewareaccess-log-check>
<label for=m-docshertztutorialsbasic-featuremiddlewareaccess-log-check><a href=/docs/hertz/tutorials/basic-feature/middleware/access-log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewareaccess-log><span>access log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaresecure-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaresecure-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaresecure-check><a href=/docs/hertz/tutorials/basic-feature/middleware/secure/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaresecure><span>Secure</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaresentry-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaresentry-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaresentry-check><a href=/docs/hertz/tutorials/basic-feature/middleware/sentry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaresentry><span>Sentry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecsrf-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecsrf-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecsrf-check><a href=/docs/hertz/tutorials/basic-feature/middleware/csrf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecsrf><span>CSRF</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecasbin-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecasbin-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecasbin-check><a href=/docs/hertz/tutorials/basic-feature/middleware/casbin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecasbin><span>Casbin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewareetag-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewareetag-check>
<label for=m-docshertztutorialsbasic-featuremiddlewareetag-check><a href=/docs/hertz/tutorials/basic-feature/middleware/etag/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewareetag><span>ETag</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecache-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecache-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecache-check><a href=/docs/hertz/tutorials/basic-feature/middleware/cache/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecache><span>Cache</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurebinding-and-validate-li><input type=checkbox id=m-docshertztutorialsbasic-featurebinding-and-validate-check>
<label for=m-docshertztutorialsbasic-featurebinding-and-validate-check><a href=/docs/hertz/tutorials/basic-feature/binding-and-validate/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurebinding-and-validate><span>Binding and validate</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorialsbasic-featureprotocol-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocol-check checked>
<label for=m-docshertztutorialsbasic-featureprotocol-check><a href=/docs/hertz/tutorials/basic-feature/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-featureprotocol><span>Protocol</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureprotocolhttp2-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocolhttp2-check>
<label for=m-docshertztutorialsbasic-featureprotocolhttp2-check><a href=/docs/hertz/tutorials/basic-feature/protocol/http2/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocolhttp2><span>HTTP2</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docshertztutorialsbasic-featureprotocolwebsocket-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocolwebsocket-check checked>
<label for=m-docshertztutorialsbasic-featureprotocolwebsocket-check><a href=/docs/hertz/tutorials/basic-feature/protocol/websocket/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocolwebsocket><span class=td-sidebar-nav-active-item>Websocket</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureprotocoltls-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocoltls-check>
<label for=m-docshertztutorialsbasic-featureprotocoltls-check><a href=/docs/hertz/tutorials/basic-feature/protocol/tls/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocoltls><span>TLS</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurestream-li><input type=checkbox id=m-docshertztutorialsbasic-featurestream-check>
<label for=m-docshertztutorialsbasic-featurestream-check><a href=/docs/hertz/tutorials/basic-feature/stream/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurestream><span>Stream</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureerror-handle-li><input type=checkbox id=m-docshertztutorialsbasic-featureerror-handle-check>
<label for=m-docshertztutorialsbasic-featureerror-handle-check><a href=/docs/hertz/tutorials/basic-feature/error-handle/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureerror-handle><span>Error Handle</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuregraceful-shutdown-li><input type=checkbox id=m-docshertztutorialsbasic-featuregraceful-shutdown-check>
<label for=m-docshertztutorialsbasic-featuregraceful-shutdown-check><a href=/docs/hertz/tutorials/basic-feature/graceful-shutdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuregraceful-shutdown><span>Graceful Shutdown</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureproxy-li><input type=checkbox id=m-docshertztutorialsbasic-featureproxy-check>
<label for=m-docshertztutorialsbasic-featureproxy-check><a href=/docs/hertz/tutorials/basic-feature/proxy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureproxy><span>Forward Proxy and Reverse Proxy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureretry-li><input type=checkbox id=m-docshertztutorialsbasic-featureretry-check>
<label for=m-docshertztutorialsbasic-featureretry-check><a href=/docs/hertz/tutorials/basic-feature/retry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureretry><span>Retry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurehooks-li><input type=checkbox id=m-docshertztutorialsbasic-featurehooks-check>
<label for=m-docshertztutorialsbasic-featurehooks-check><a href=/docs/hertz/tutorials/basic-feature/hooks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurehooks><span>Hooks</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureunit-test-li><input type=checkbox id=m-docshertztutorialsbasic-featureunit-test-check>
<label for=m-docshertztutorialsbasic-featureunit-test-check><a href=/docs/hertz/tutorials/basic-feature/unit-test/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureunit-test><span>Unit Test</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureadaptor-li><input type=checkbox id=m-docshertztutorialsbasic-featureadaptor-check>
<label for=m-docshertztutorialsbasic-featureadaptor-check><a href=/docs/hertz/tutorials/basic-feature/adaptor/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureadaptor><span>Adaptor</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsobservability-li><input type=checkbox id=m-docshertztutorialsobservability-check>
<label for=m-docshertztutorialsobservability-check><a href=/docs/hertz/tutorials/observability/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsobservability><span>Observability</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilitylog-li><input type=checkbox id=m-docshertztutorialsobservabilitylog-check>
<label for=m-docshertztutorialsobservabilitylog-check><a href=/docs/hertz/tutorials/observability/log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilitylog><span>Log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilitytracing-li><input type=checkbox id=m-docshertztutorialsobservabilitytracing-check>
<label for=m-docshertztutorialsobservabilitytracing-check><a href=/docs/hertz/tutorials/observability/tracing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilitytracing><span>Tracing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilitymonitoring-li><input type=checkbox id=m-docshertztutorialsobservabilitymonitoring-check>
<label for=m-docshertztutorialsobservabilitymonitoring-check><a href=/docs/hertz/tutorials/observability/monitoring/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilitymonitoring><span>Monitoring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilityopen-telemetry-li><input type=checkbox id=m-docshertztutorialsobservabilityopen-telemetry-check>
<label for=m-docshertztutorialsobservabilityopen-telemetry-check><a href=/docs/hertz/tutorials/observability/open-telemetry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilityopen-telemetry><span>OpenTelemetry</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsservice-governance-li><input type=checkbox id=m-docshertztutorialsservice-governance-check>
<label for=m-docshertztutorialsservice-governance-check><a href=/docs/hertz/tutorials/service-governance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsservice-governance><span>Service Governance</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsservice-governanceservice_discovery-li><input type=checkbox id=m-docshertztutorialsservice-governanceservice_discovery-check>
<label for=m-docshertztutorialsservice-governanceservice_discovery-check><a href=/docs/hertz/tutorials/service-governance/service_discovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsservice-governanceservice_discovery><span>Service Registration and Discovery</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsservice-governancesentinel-li><input type=checkbox id=m-docshertztutorialsservice-governancesentinel-check>
<label for=m-docshertztutorialsservice-governancesentinel-check><a href=/docs/hertz/tutorials/service-governance/sentinel/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsservice-governancesentinel><span>Sentinel</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsframework-exten-li><input type=checkbox id=m-docshertztutorialsframework-exten-check>
<label for=m-docshertztutorialsframework-exten-check><a href=/docs/hertz/tutorials/framework-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsframework-exten><span>Framework Extension</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenmonitor-li><input type=checkbox id=m-docshertztutorialsframework-extenmonitor-check>
<label for=m-docshertztutorialsframework-extenmonitor-check><a href=/docs/hertz/tutorials/framework-exten/monitor/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenmonitor><span>Monitoring Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenlog-li><input type=checkbox id=m-docshertztutorialsframework-extenlog-check>
<label for=m-docshertztutorialsframework-extenlog-check><a href=/docs/hertz/tutorials/framework-exten/log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenlog><span>Logger Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenservice_discovery-li><input type=checkbox id=m-docshertztutorialsframework-extenservice_discovery-check>
<label for=m-docshertztutorialsframework-extenservice_discovery-check><a href=/docs/hertz/tutorials/framework-exten/service_discovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenservice_discovery><span>Service Registration and Service Discovery Extensions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsframework-extenadvanced-exten-li><input type=checkbox id=m-docshertztutorialsframework-extenadvanced-exten-check>
<label for=m-docshertztutorialsframework-extenadvanced-exten-check><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsframework-extenadvanced-exten><span>Advanced Extensions</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-li><input type=checkbox id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-check>
<label for=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-check><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/network-lib/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib><span>Network Library Extensions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenadvanced-extenprotocol-li><input type=checkbox id=m-docshertztutorialsframework-extenadvanced-extenprotocol-check>
<label for=m-docshertztutorialsframework-extenadvanced-extenprotocol-check><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenadvanced-extenprotocol><span>Protocol extension</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenresponse_writer-li><input type=checkbox id=m-docshertztutorialsframework-extenresponse_writer-check>
<label for=m-docshertztutorialsframework-extenresponse_writer-check><a href=/docs/hertz/tutorials/framework-exten/response_writer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenresponse_writer><span>Response Writer Extension</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialstoolkit-li><input type=checkbox id=m-docshertztutorialstoolkit-check>
<label for=m-docshertztutorialstoolkit-check><a href=/docs/hertz/tutorials/toolkit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialstoolkit><span>Code Generation</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialstoolkitusage-li><input type=checkbox id=m-docshertztutorialstoolkitusage-check>
<label for=m-docshertztutorialstoolkitusage-check><a href=/docs/hertz/tutorials/toolkit/usage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialstoolkitusage><span>hz usages</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageinstall-li><input type=checkbox id=m-docshertztutorialstoolkitusageinstall-check>
<label for=m-docshertztutorialstoolkitusageinstall-check><a href=/docs/hertz/tutorials/toolkit/usage/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageinstall><span>hz install</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageusage-li><input type=checkbox id=m-docshertztutorialstoolkitusageusage-check>
<label for=m-docshertztutorialstoolkitusageusage-check><a href=/docs/hertz/tutorials/toolkit/usage/usage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageusage><span>hz basic usage</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageusage-thrift-li><input type=checkbox id=m-docshertztutorialstoolkitusageusage-thrift-check>
<label for=m-docshertztutorialstoolkitusageusage-thrift-check><a href=/docs/hertz/tutorials/toolkit/usage/usage-thrift/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageusage-thrift><span>hz usage(thrift)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageusage-protobuf-li><input type=checkbox id=m-docshertztutorialstoolkitusageusage-protobuf-check>
<label for=m-docshertztutorialstoolkitusageusage-protobuf-check><a href=/docs/hertz/tutorials/toolkit/usage/usage-protobuf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageusage-protobuf><span>hz usage(protobuf)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusagelayout-li><input type=checkbox id=m-docshertztutorialstoolkitusagelayout-check>
<label for=m-docshertztutorialstoolkitusagelayout-check><a href=/docs/hertz/tutorials/toolkit/usage/layout/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusagelayout><span>hz layout</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageannotation-li><input type=checkbox id=m-docshertztutorialstoolkitusageannotation-check>
<label for=m-docshertztutorialstoolkitusageannotation-check><a href=/docs/hertz/tutorials/toolkit/usage/annotation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageannotation><span>hz annotation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusagecommand-li><input type=checkbox id=m-docshertztutorialstoolkitusagecommand-check>
<label for=m-docshertztutorialstoolkitusagecommand-check><a href=/docs/hertz/tutorials/toolkit/usage/command/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusagecommand><span>hz commands</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusagecautions-li><input type=checkbox id=m-docshertztutorialstoolkitusagecautions-check>
<label for=m-docshertztutorialstoolkitusagecautions-check><a href=/docs/hertz/tutorials/toolkit/usage/cautions/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusagecautions><span>note</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkittemplate-li><input type=checkbox id=m-docshertztutorialstoolkittemplate-check>
<label for=m-docshertztutorialstoolkittemplate-check><a href=/docs/hertz/tutorials/toolkit/template/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkittemplate><span>hz custom template use</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitplugin-li><input type=checkbox id=m-docshertztutorialstoolkitplugin-check>
<label for=m-docshertztutorialstoolkitplugin-check><a href=/docs/hertz/tutorials/toolkit/plugin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitplugin><span>hz access plugin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitclient-li><input type=checkbox id=m-docshertztutorialstoolkitclient-check>
<label for=m-docshertztutorialstoolkitclient-check><a href=/docs/hertz/tutorials/toolkit/client/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitclient><span>hz client code generation</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzfaq-li><input type=checkbox id=m-docshertzfaq-check checked>
<label for=m-docshertzfaq-check><a href=/docs/hertz/faq/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzfaq><span>FAQ</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertzreference-li><input type=checkbox id=m-docshertzreference-check checked>
<label for=m-docshertzreference-check><a href=/docs/hertz/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzreference><span>Reference</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferenceconfig-li><input type=checkbox id=m-docshertzreferenceconfig-check>
<label for=m-docshertzreferenceconfig-check><a href=/docs/hertz/reference/config/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferenceconfig><span>Configuration instruction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferenceversion-li><input type=checkbox id=m-docshertzreferenceversion-check>
<label for=m-docshertzreferenceversion-check><a href=/docs/hertz/reference/version/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferenceversion><span>Version Descriptions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferencejson-li><input type=checkbox id=m-docshertzreferencejson-check>
<label for=m-docshertzreferencejson-check><a href=/docs/hertz/reference/json/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferencejson><span>JSON Marshal Library</span></a></label></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/cloudwego/cloudwego.github.io/edit/main/content/en/docs/hertz/tutorials/basic-feature/protocol/websocket.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/new/main/content/en/docs/hertz/tutorials/basic-feature/protocol/websocket.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/issues/new?title=Websocket" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/cloudwego/kitex/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#install>Install</a></li><li><a href=#example>Example</a></li><li><a href=#config>Config</a><ul><li><a href=#writebufferpool>WriteBufferPool</a></li><li><a href=#subprotocols>Subprotocols</a></li><li><a href=#error>Error</a></li><li><a href=#checkorigin>CheckOrigin</a></li><li><a href=#enablecompression>EnableCompression</a></li><li><a href=#setreadtimeoutsetwritetimeout>SetReadTimeout/SetWriteTimeout</a></li></ul></li><li><a href=#nohijackconnpool>NoHijackConnPool</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/>Hertz</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/tutorials/>Tutorials</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/tutorials/basic-feature/>Basic Feature</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/tutorials/basic-feature/protocol/>Protocol</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://www.cloudwego.io/docs/hertz/tutorials/basic-feature/protocol/websocket/>Websocket</a></li></ol></nav><div class=td-content><h1>Websocket</h1><header class=article-meta></header><p>WebSocket is a type of full-duplex communication that can be performed on a single TCP connection and is located at the application layer of the OSI model.
WebSocket makes data exchange between client and server easier, allowing the server to actively push data to the client.
In the WebSocket API, the browser and the server only need to complete a handshake that a persistent connection can be created between the two, and two-way data transmission can be performed.</p><p>Hertz provides support for WebSocket and adapts it in Hertz by referring to <a href=https://github.com/gorilla/websocket>gorilla/websocket</a> using <code>hijack</code>.
The usage and parameters are basically the same.</p><h2 id=install>Install</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>go get github.com/hertz-contrib/websocket
</code></pre></div><h2 id=example>Example</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;flag&#34;</span>
    <span style=color:#4e9a06>&#34;html/template&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/websocket&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>addr</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>flag</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;addr&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;localhost:8080&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http service address&#34;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>upgrader</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>websocket</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HertzUpgrader</span><span style=color:#000;font-weight:700>{}</span> <span style=color:#8f5902;font-style:italic>// use default options
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>_</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>upgrader</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Upgrade</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>websocket</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>mt</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>conn</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ReadMessage</span><span style=color:#000;font-weight:700>()</span>
            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
                <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Println</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;read:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
                <span style=color:#204a87;font-weight:700>break</span>
            <span style=color:#000;font-weight:700>}</span>
            <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;recv: %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>)</span>
            <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>conn</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WriteMessage</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>mt</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>)</span>
            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
                <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Println</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;write:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
                <span style=color:#204a87;font-weight:700>break</span>
            <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;upgrade:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>home</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>_</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SetContentType</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;text/html; charset=utf-8&#34;</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>homeTemplate</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Execute</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;ws://&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Host</span><span style=color:#000;font-weight:700>())</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34;/echo&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>flag</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Parse</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// https://github.com/cloudwego/hertz/issues/121
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NoHijackConnPool</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>home</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/echo&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>echo</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#8f5902;font-style:italic>// Web client code details are available at: https://github.com/hertz-contrib/websocket/blob/main/examples/echo/server.go#L64
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>homeTemplate</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;&#34;</span>
</code></pre></div><p>run websocket server:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>go run server.go
</code></pre></div><p>In the example code above, the server includes a simple web client. To use this client, open <a href>http://127.0.0.1:8080</a> in your browser and follow the instructions on the page.</p><h2 id=config>Config</h2><p>The following is the optional configuration parameters for using Hertz WebSocket.</p><p>This section is organized around the <code>websocket.HertzUpgrader</code> structure.</p><table><thead><tr><th>Parameter</th><th>Introduction</th></tr></thead><tbody><tr><td><code>ReadBufferSize</code></td><td>Used to set the size of the read buffer in bytes. If the buffer size is zero, then the size allocated by the HTTP server is used. The read buffer size does not limit the size of the messages that can be received.</td></tr><tr><td><code>WriteBufferSize</code></td><td>Used to set the size of the write buffer in bytes. If the buffer size is zero, then the size allocated by the HTTP server is used. The write buffer size does not limit the size of the messages that can be sent.</td></tr><tr><td><code>WriteBufferPool</code></td><td>Used to set the buffer pool for write operations.</td></tr><tr><td><code>Subprotocols</code></td><td>Used to set the protocols supported by the server in order of preference. If this field is not nil, then the Upgrade method negotiates a sub-protocol by selecting the first match in this list to the protocol requested by the client. If there is no match, then no protocol is negotiated (the Sec-Websocket-Protocol header is not included in the handshake response).</td></tr><tr><td><code>Error</code></td><td>Used to set a function the generation of HTTP error responses.</td></tr><tr><td><code>CheckOrigin</code></td><td>Used to set a check function for Origin header for the request. If the Origin header of the request is acceptable, CheckOrigin returns true.</td></tr><tr><td><code>EnableCompression</code></td><td>Used to set whether the server should attempt to negotiate compression for each message (RFC 7692). Setting this value to true does not guarantee that compression will be supported.</td></tr></tbody></table><h3 id=writebufferpool>WriteBufferPool</h3><p>If this value is not set, an additional write buffer is initialized and allocated to the connection for the current lifetime. The buffer pool is most useful when the application has a moderate amount of writes on a large number of connections.</p><p>Applications should use <strong>a single</strong> buffer pool to allocate buffers for different connections.</p><p>Interface Description:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#8f5902;font-style:italic>// BufferPool represents a pool of buffers. The *sync.Pool type satisfies this
</span><span style=color:#8f5902;font-style:italic>// interface.  The type of the value stored in a pool is not specified.
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>BufferPool</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// Get gets a value from the pool or returns nil if the pool is empty.
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>Get</span><span style=color:#000;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}</span>
    <span style=color:#8f5902;font-style:italic>// Put adds a value to the pool.
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>Put</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>Sample Code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>simpleBufferPool</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>v</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>simpleBufferPool</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Get</span><span style=color:#000;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{}</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>v</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>v</span>
    <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>v</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>nil</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>v</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>p</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>simpleBufferPool</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Put</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>v</span> <span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>{})</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>v</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>v</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>upgrader</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>websocket</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HertzUpgrader</span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>WriteBufferPool</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>simpleBufferPool</span><span style=color:#000;font-weight:700>{},</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=subprotocols>Subprotocols</h3><p>WebSocket simply defines a mechanism for exchanging arbitrary messages. What those messages mean, what kind of messages the client can expect at any given point in time, or what kind of messages they are allowed to send, depends entirely on the implementing application.</p><p>So you need an agreement between the server and the client about these things. The subprotocol parameters simply allow the client and server to formally exchange this information. You can make up any name for any protocol you want. The server can simply check that the client has followed that protocol during the handshake.</p><h3 id=error>Error</h3><p>If Error is nil, then use the API provided by Hertz to generate the HTTP error response.</p><p>Function signatures:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>reason</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Sample Code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>upgrader</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>websocket</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HertzUpgrader</span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>Error</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>reason</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Response</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Sec-Websocket-Version&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;13&#34;</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AbortWithMsg</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>reason</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>},</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=checkorigin>CheckOrigin</h3><p>CheckOrigin returns true if the request Origin header is acceptable. If CheckOrigin is nil, then a safe default is used: return false if the Origin request header is present and the origin host is not equal to request Host header.</p><p>A CheckOrigin function should carefully validate the request origin to
prevent cross-site request forgery.</p><p>Function signatures:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>bool</span>
</code></pre></div><p>Default Implementation:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>fastHTTPCheckSameOrigin</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>bool</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>origin</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Peek</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Origin&#34;</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>origin</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>u</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>url</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>b2s</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>origin</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>equalASCIIFold</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>u</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Host</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b2s</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Host</span><span style=color:#000;font-weight:700>()))</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=enablecompression>EnableCompression</h3><p>The server accepts one or more extension fields that are included in the <code>Sec-WebSocket-Extensions</code> header field extensions requested by the client. When EnableCompression is true, the server matches the extensions it currently supports with its extensions, and supports compression if the match is successful.</p><p>Currently only the &ldquo;no context takeover&rdquo; mode is supported, as described in the <code>HertzUpgrader.Upgrade</code>.</p><h3 id=setreadtimeoutsetwritetimeout>SetReadTimeout/SetWriteTimeout</h3><p>When using websockets for reading and writing, the read timeout or write timeout can be set similarly as follows.</p><p>Sample Code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>_</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>upgrader</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Upgrade</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>websocket</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>conn</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Close</span><span style=color:#000;font-weight:700>()</span>
        <span style=color:#8f5902;font-style:italic>// &#34;github.com/cloudwego/hertz/pkg/network&#34;
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>conn</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NetConn</span><span style=color:#000;font-weight:700>().(</span><span style=color:#000>network</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>SetReadTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000>conn</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NetConn</span><span style=color:#000;font-weight:700>().(</span><span style=color:#000>network</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>SetWriteTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#ce5c00;font-weight:700>...</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;upgrade:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h2 id=nohijackconnpool>NoHijackConnPool</h2><blockquote><p>The hijack conn used for Hertz connection hijacking is pooled and therefore does not support asynchronous operations when the hijacked connection is used in a websocket.</p></blockquote><p>A hijacked connection can only be closed once, and a second closure will result in a null pointer exception.</p><p>NoHijackConnPool will control whether invite pool to acquire/release the hijackConn or not.</p><p>If cache pooling is used, it will improve the performance of memory resource allocation, but it will not avoid the exception caused by closing the connection twice.</p><p>If it is difficult to guarantee that hijackConn will not be closed repeatedly, set it to true.</p><p>Sample Code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#ce5c00;font-weight:700>...</span>
    <span style=color:#8f5902;font-style:italic>// https://github.com/cloudwego/hertz/issues/121
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NoHijackConnPool</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span>
    <span style=color:#ce5c00;font-weight:700>...</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>As for usage, you may refer to <a href=https://github.com/hertz-contrib/websocket/tree/main/examples>examples</a>.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector('.feedback--answer-yes'),noButton=document.querySelector('.feedback--answer-no'),yesResponse=document.querySelector('.feedback--response-yes'),noResponse=document.querySelector('.feedback--response-no'),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=b=>{if(typeof ga!='function')return;const a={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:b};ga(a.command,a.hitType,a.category,a.action,a.label,a.value)};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(1)}),noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified
April 11, 2023
: <a href=https://github.com/cloudwego/cloudwego.github.io/commit/237eda3f3f9aaa78d070c6eb9b823760cd1285c2>chore: fix npm security issue (#600) (237eda3)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Lark aria-label=Lark><a class=text-white target=_blank rel=noopener href="https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=693v2544-2664-4421-b50f-7f1912p745r6" aria-label=Lark><img src=/webfonts/lark.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/CloudWeGo aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/cloudwego aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://join.slack.com/t/cloudwego/shared_invite/zt-tmcbzewn-UjXMF3ZQsPhl7W3tEDZboA aria-label=Slack><i class="fab fa-slack"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 The CloudWeGo Authors</small><p class="mt-2 text-white"><a class=cloudwego-link href=/about/ target=_blank rel=noopener>About</a>
|
<a class=cloudwego-link href=https://github.com/cloudwego/cloudwego.github.io/blob/main/LICENSE target=_blank rel=noopener>License</a></p></div></div></div></footer></div><script src=https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.staticfile.org/bootstrap/4.6.0/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/main.min.cc7c4d018c27afc5b5c4e9ddd9f5b1fca60e2005312b12b5bec0518202c51314.js integrity="sha256-zHxNAYwnr8W1xOnd2fWx/KYOIAUxKxK1vsBRggLFExQ=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/outbound-link.js></script><script src=/js/navScroll.js></script></body></html>