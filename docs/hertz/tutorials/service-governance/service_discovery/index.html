<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.85.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Service Registration and Discovery | CloudWeGo</title><meta name=description content="A leading practice for building enterprise cloud native middleware!"><meta property="og:title" content="Service Registration and Discovery"><meta property="og:description" content="The service discovery extensions currently supported in the open source version of Hertz are stored in the registry. You are welcomed to join us in contributing and maintaining for this project.
As of now, the supported service discovery extensions are
 nacos consul etcd eureka polaris servicecomb zookeeper redis  Configuration Some optional configurations are provided to users when using service discovery.
   Configuration Description     WithSD Set isSD to true , required to use service discovery."><meta property="og:type" content="article"><meta property="og:url" content="https://www.cloudwego.io/docs/hertz/tutorials/service-governance/service_discovery/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-08-14T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-13T11:23:38+08:00"><meta property="og:site_name" content="CloudWeGo"><meta itemprop=name content="Service Registration and Discovery"><meta itemprop=description content="The service discovery extensions currently supported in the open source version of Hertz are stored in the registry. You are welcomed to join us in contributing and maintaining for this project.
As of now, the supported service discovery extensions are
 nacos consul etcd eureka polaris servicecomb zookeeper redis  Configuration Some optional configurations are provided to users when using service discovery.
   Configuration Description     WithSD Set isSD to true , required to use service discovery."><meta itemprop=datePublished content="2022-08-14T00:00:00+00:00"><meta itemprop=dateModified content="2023-04-13T11:23:38+08:00"><meta itemprop=wordCount content="5213"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Service Registration and Discovery"><meta name=twitter:description content="The service discovery extensions currently supported in the open source version of Hertz are stored in the registry. You are welcomed to join us in contributing and maintaining for this project.
As of now, the supported service discovery extensions are
 nacos consul etcd eureka polaris servicecomb zookeeper redis  Configuration Some optional configurations are provided to users when using service discovery.
   Configuration Description     WithSD Set isSD to true , required to use service discovery."><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYWRQRLPRM')</script><script>var _hmt=_hmt||[];(function(){var a=document.createElement("script"),b;a.src="https://hm.baidu.com/hm.js?f1808c42af827f368aa7eca3baae6d55",b=document.getElementsByTagName("script")[0],b.parentNode.insertBefore(a,b)})()</script><link rel=preload href=/scss/main.min.8090891c264e3fa6623cbdac7ce42c1259703e8068886edd79eb5ec5f88cd0c9.css as=style><link href=/scss/main.min.8090891c264e3fa6623cbdac7ce42c1259703e8068886edd79eb5ec5f88cd0c9.css rel=stylesheet integrity><script src=https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=/css/docsearch.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYWRQRLPRM','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand-xl navbar-dark td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0 ml-auto"><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Documentation</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/kitex/>Kitex</a>
<a class=dropdown-item href=/docs/hertz/>Hertz</a>
<a class=dropdown-item href=/docs/volo/>Volo</a>
<a class=dropdown-item href=/docs/netpoll/>Netpoll</a>
<a class=dropdown-item href=/docs/cwgo/>Cwgo</a>
<a class=dropdown-item href=/docs/motore/>Motore</a>
<a class=dropdown-item href=/docs/pilota/>Pilota</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/cooperation/><span>Cooperation</span></a></li><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Security</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/security/safety-bulletin/>safety-bulletin</a>
<a class=dropdown-item href=/security/vulnerability-reporting/>vulnerability-reporting</a></div></li><li class="nav-item dropdown mr-4"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/hertz/tutorials/service-governance/service_discovery/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div id=docsearch></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div id=docsearch></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/hertz/tutorials/service-governance/service_discovery/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertz-li><input type=checkbox id=m-docshertz-check checked>
<label for=m-docshertz-check><a href=/docs/hertz/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertz><span>Hertz</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzoverview-li><input type=checkbox id=m-docshertzoverview-check checked>
<label for=m-docshertzoverview-check><a href=/docs/hertz/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzoverview><span>Overview</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzgetting-started-li><input type=checkbox id=m-docshertzgetting-started-check checked>
<label for=m-docshertzgetting-started-check><a href=/docs/hertz/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzgetting-started><span>Getting Started</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorials-li><input type=checkbox id=m-docshertztutorials-check checked>
<label for=m-docshertztutorials-check><a href=/docs/hertz/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorials><span>Tutorials</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsexample-li><input type=checkbox id=m-docshertztutorialsexample-check>
<label for=m-docshertztutorialsexample-check><a href=/docs/hertz/tutorials/example/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsexample><span>Example code</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsbasic-feature-li><input type=checkbox id=m-docshertztutorialsbasic-feature-check>
<label for=m-docshertztutorialsbasic-feature-check><a href=/docs/hertz/tutorials/basic-feature/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-feature><span>Basic Feature</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurenetwork-lib-li><input type=checkbox id=m-docshertztutorialsbasic-featurenetwork-lib-check>
<label for=m-docshertztutorialsbasic-featurenetwork-lib-check><a href=/docs/hertz/tutorials/basic-feature/network-lib/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurenetwork-lib><span>Network Lib</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureroute-li><input type=checkbox id=m-docshertztutorialsbasic-featureroute-check>
<label for=m-docshertztutorialsbasic-featureroute-check><a href=/docs/hertz/tutorials/basic-feature/route/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureroute><span>Route</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsbasic-featuremiddleware-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddleware-check>
<label for=m-docshertztutorialsbasic-featuremiddleware-check><a href=/docs/hertz/tutorials/basic-feature/middleware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-featuremiddleware><span>Middleware Overview</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecors-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecors-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecors-check><a href=/docs/hertz/tutorials/basic-feature/middleware/cors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecors><span>CORS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarerecovery-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarerecovery-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarerecovery-check><a href=/docs/hertz/tutorials/basic-feature/middleware/recovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarerecovery><span>Recovery</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-check><a href=/docs/hertz/tutorials/basic-feature/middleware/basic-auth/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth><span>Basic Auth</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarejwt-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarejwt-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarejwt-check><a href=/docs/hertz/tutorials/basic-feature/middleware/jwt/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarejwt><span>JWT</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaregzip-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaregzip-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaregzip-check><a href=/docs/hertz/tutorials/basic-feature/middleware/gzip/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaregzip><span>Gzip Compress</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarei18n-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarei18n-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarei18n-check><a href=/docs/hertz/tutorials/basic-feature/middleware/i18n/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarei18n><span>Internationalization</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaresession-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaresession-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaresession-check><a href=/docs/hertz/tutorials/basic-feature/middleware/session/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaresession><span>Session Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarepprof-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarepprof-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarepprof-check><a href=/docs/hertz/tutorials/basic-feature/middleware/pprof/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarepprof><span>Pprof</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarekeyauth-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarekeyauth-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarekeyauth-check><a href=/docs/hertz/tutorials/basic-feature/middleware/keyauth/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarekeyauth><span>KeyAuth</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewareswagger-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewareswagger-check>
<label for=m-docshertztutorialsbasic-featuremiddlewareswagger-check><a href=/docs/hertz/tutorials/basic-feature/middleware/swagger/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewareswagger><span>Swagger</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarerequestid-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarerequestid-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarerequestid-check><a href=/docs/hertz/tutorials/basic-feature/middleware/requestid/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarerequestid><span>Request ID</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewareaccess-log-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewareaccess-log-check>
<label for=m-docshertztutorialsbasic-featuremiddlewareaccess-log-check><a href=/docs/hertz/tutorials/basic-feature/middleware/access-log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewareaccess-log><span>access log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaresecure-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaresecure-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaresecure-check><a href=/docs/hertz/tutorials/basic-feature/middleware/secure/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaresecure><span>Secure</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewaresentry-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewaresentry-check>
<label for=m-docshertztutorialsbasic-featuremiddlewaresentry-check><a href=/docs/hertz/tutorials/basic-feature/middleware/sentry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewaresentry><span>Sentry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecsrf-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecsrf-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecsrf-check><a href=/docs/hertz/tutorials/basic-feature/middleware/csrf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecsrf><span>CSRF</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecasbin-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecasbin-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecasbin-check><a href=/docs/hertz/tutorials/basic-feature/middleware/casbin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecasbin><span>Casbin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewareetag-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewareetag-check>
<label for=m-docshertztutorialsbasic-featuremiddlewareetag-check><a href=/docs/hertz/tutorials/basic-feature/middleware/etag/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewareetag><span>ETag</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecache-li><input type=checkbox id=m-docshertztutorialsbasic-featuremiddlewarecache-check>
<label for=m-docshertztutorialsbasic-featuremiddlewarecache-check><a href=/docs/hertz/tutorials/basic-feature/middleware/cache/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecache><span>Cache</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurebinding-and-validate-li><input type=checkbox id=m-docshertztutorialsbasic-featurebinding-and-validate-check>
<label for=m-docshertztutorialsbasic-featurebinding-and-validate-check><a href=/docs/hertz/tutorials/basic-feature/binding-and-validate/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurebinding-and-validate><span>Binding and validate</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsbasic-featureprotocol-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocol-check>
<label for=m-docshertztutorialsbasic-featureprotocol-check><a href=/docs/hertz/tutorials/basic-feature/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-featureprotocol><span>Protocol</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureprotocolhttp2-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocolhttp2-check>
<label for=m-docshertztutorialsbasic-featureprotocolhttp2-check><a href=/docs/hertz/tutorials/basic-feature/protocol/http2/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocolhttp2><span>HTTP2</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureprotocolwebsocket-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocolwebsocket-check>
<label for=m-docshertztutorialsbasic-featureprotocolwebsocket-check><a href=/docs/hertz/tutorials/basic-feature/protocol/websocket/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocolwebsocket><span>Websocket</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureprotocoltls-li><input type=checkbox id=m-docshertztutorialsbasic-featureprotocoltls-check>
<label for=m-docshertztutorialsbasic-featureprotocoltls-check><a href=/docs/hertz/tutorials/basic-feature/protocol/tls/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocoltls><span>TLS</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurestream-li><input type=checkbox id=m-docshertztutorialsbasic-featurestream-check>
<label for=m-docshertztutorialsbasic-featurestream-check><a href=/docs/hertz/tutorials/basic-feature/stream/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurestream><span>Stream</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureerror-handle-li><input type=checkbox id=m-docshertztutorialsbasic-featureerror-handle-check>
<label for=m-docshertztutorialsbasic-featureerror-handle-check><a href=/docs/hertz/tutorials/basic-feature/error-handle/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureerror-handle><span>Error Handle</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuregraceful-shutdown-li><input type=checkbox id=m-docshertztutorialsbasic-featuregraceful-shutdown-check>
<label for=m-docshertztutorialsbasic-featuregraceful-shutdown-check><a href=/docs/hertz/tutorials/basic-feature/graceful-shutdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuregraceful-shutdown><span>Graceful Shutdown</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureproxy-li><input type=checkbox id=m-docshertztutorialsbasic-featureproxy-check>
<label for=m-docshertztutorialsbasic-featureproxy-check><a href=/docs/hertz/tutorials/basic-feature/proxy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureproxy><span>Forward Proxy and Reverse Proxy</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureretry-li><input type=checkbox id=m-docshertztutorialsbasic-featureretry-check>
<label for=m-docshertztutorialsbasic-featureretry-check><a href=/docs/hertz/tutorials/basic-feature/retry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureretry><span>Retry</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurehooks-li><input type=checkbox id=m-docshertztutorialsbasic-featurehooks-check>
<label for=m-docshertztutorialsbasic-featurehooks-check><a href=/docs/hertz/tutorials/basic-feature/hooks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurehooks><span>Hooks</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureunit-test-li><input type=checkbox id=m-docshertztutorialsbasic-featureunit-test-check>
<label for=m-docshertztutorialsbasic-featureunit-test-check><a href=/docs/hertz/tutorials/basic-feature/unit-test/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureunit-test><span>Unit Test</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureadaptor-li><input type=checkbox id=m-docshertztutorialsbasic-featureadaptor-check>
<label for=m-docshertztutorialsbasic-featureadaptor-check><a href=/docs/hertz/tutorials/basic-feature/adaptor/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureadaptor><span>Adaptor</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsobservability-li><input type=checkbox id=m-docshertztutorialsobservability-check>
<label for=m-docshertztutorialsobservability-check><a href=/docs/hertz/tutorials/observability/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsobservability><span>Observability</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilitylog-li><input type=checkbox id=m-docshertztutorialsobservabilitylog-check>
<label for=m-docshertztutorialsobservabilitylog-check><a href=/docs/hertz/tutorials/observability/log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilitylog><span>Log</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilitytracing-li><input type=checkbox id=m-docshertztutorialsobservabilitytracing-check>
<label for=m-docshertztutorialsobservabilitytracing-check><a href=/docs/hertz/tutorials/observability/tracing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilitytracing><span>Tracing</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilitymonitoring-li><input type=checkbox id=m-docshertztutorialsobservabilitymonitoring-check>
<label for=m-docshertztutorialsobservabilitymonitoring-check><a href=/docs/hertz/tutorials/observability/monitoring/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilitymonitoring><span>Monitoring</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsobservabilityopen-telemetry-li><input type=checkbox id=m-docshertztutorialsobservabilityopen-telemetry-check>
<label for=m-docshertztutorialsobservabilityopen-telemetry-check><a href=/docs/hertz/tutorials/observability/open-telemetry/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsobservabilityopen-telemetry><span>OpenTelemetry</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorialsservice-governance-li><input type=checkbox id=m-docshertztutorialsservice-governance-check checked>
<label for=m-docshertztutorialsservice-governance-check><a href=/docs/hertz/tutorials/service-governance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsservice-governance><span>Service Governance</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docshertztutorialsservice-governanceservice_discovery-li><input type=checkbox id=m-docshertztutorialsservice-governanceservice_discovery-check checked>
<label for=m-docshertztutorialsservice-governanceservice_discovery-check><a href=/docs/hertz/tutorials/service-governance/service_discovery/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsservice-governanceservice_discovery><span class=td-sidebar-nav-active-item>Service Registration and Discovery</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsservice-governancesentinel-li><input type=checkbox id=m-docshertztutorialsservice-governancesentinel-check>
<label for=m-docshertztutorialsservice-governancesentinel-check><a href=/docs/hertz/tutorials/service-governance/sentinel/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsservice-governancesentinel><span>Sentinel</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsframework-exten-li><input type=checkbox id=m-docshertztutorialsframework-exten-check>
<label for=m-docshertztutorialsframework-exten-check><a href=/docs/hertz/tutorials/framework-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsframework-exten><span>Framework Extension</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenmonitor-li><input type=checkbox id=m-docshertztutorialsframework-extenmonitor-check>
<label for=m-docshertztutorialsframework-extenmonitor-check><a href=/docs/hertz/tutorials/framework-exten/monitor/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenmonitor><span>Monitoring Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenlog-li><input type=checkbox id=m-docshertztutorialsframework-extenlog-check>
<label for=m-docshertztutorialsframework-extenlog-check><a href=/docs/hertz/tutorials/framework-exten/log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenlog><span>Logger Extension</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenservice_discovery-li><input type=checkbox id=m-docshertztutorialsframework-extenservice_discovery-check>
<label for=m-docshertztutorialsframework-extenservice_discovery-check><a href=/docs/hertz/tutorials/framework-exten/service_discovery/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenservice_discovery><span>Service Registration and Service Discovery Extensions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsframework-extenadvanced-exten-li><input type=checkbox id=m-docshertztutorialsframework-extenadvanced-exten-check>
<label for=m-docshertztutorialsframework-extenadvanced-exten-check><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsframework-extenadvanced-exten><span>Advanced Extensions</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-li><input type=checkbox id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-check>
<label for=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-check><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/network-lib/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib><span>Network Library Extensions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenadvanced-extenprotocol-li><input type=checkbox id=m-docshertztutorialsframework-extenadvanced-extenprotocol-check>
<label for=m-docshertztutorialsframework-extenadvanced-extenprotocol-check><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenadvanced-extenprotocol><span>Protocol extension</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenresponse_writer-li><input type=checkbox id=m-docshertztutorialsframework-extenresponse_writer-check>
<label for=m-docshertztutorialsframework-extenresponse_writer-check><a href=/docs/hertz/tutorials/framework-exten/response_writer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenresponse_writer><span>Response Writer Extension</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialstoolkit-li><input type=checkbox id=m-docshertztutorialstoolkit-check>
<label for=m-docshertztutorialstoolkit-check><a href=/docs/hertz/tutorials/toolkit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialstoolkit><span>Code Generation</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialstoolkitusage-li><input type=checkbox id=m-docshertztutorialstoolkitusage-check>
<label for=m-docshertztutorialstoolkitusage-check><a href=/docs/hertz/tutorials/toolkit/usage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialstoolkitusage><span>hz usages</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageinstall-li><input type=checkbox id=m-docshertztutorialstoolkitusageinstall-check>
<label for=m-docshertztutorialstoolkitusageinstall-check><a href=/docs/hertz/tutorials/toolkit/usage/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageinstall><span>hz install</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageusage-li><input type=checkbox id=m-docshertztutorialstoolkitusageusage-check>
<label for=m-docshertztutorialstoolkitusageusage-check><a href=/docs/hertz/tutorials/toolkit/usage/usage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageusage><span>hz basic usage</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageusage-thrift-li><input type=checkbox id=m-docshertztutorialstoolkitusageusage-thrift-check>
<label for=m-docshertztutorialstoolkitusageusage-thrift-check><a href=/docs/hertz/tutorials/toolkit/usage/usage-thrift/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageusage-thrift><span>hz usage(thrift)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageusage-protobuf-li><input type=checkbox id=m-docshertztutorialstoolkitusageusage-protobuf-check>
<label for=m-docshertztutorialstoolkitusageusage-protobuf-check><a href=/docs/hertz/tutorials/toolkit/usage/usage-protobuf/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageusage-protobuf><span>hz usage(protobuf)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusagelayout-li><input type=checkbox id=m-docshertztutorialstoolkitusagelayout-check>
<label for=m-docshertztutorialstoolkitusagelayout-check><a href=/docs/hertz/tutorials/toolkit/usage/layout/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusagelayout><span>hz layout</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusageannotation-li><input type=checkbox id=m-docshertztutorialstoolkitusageannotation-check>
<label for=m-docshertztutorialstoolkitusageannotation-check><a href=/docs/hertz/tutorials/toolkit/usage/annotation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusageannotation><span>hz annotation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusagecommand-li><input type=checkbox id=m-docshertztutorialstoolkitusagecommand-check>
<label for=m-docshertztutorialstoolkitusagecommand-check><a href=/docs/hertz/tutorials/toolkit/usage/command/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusagecommand><span>hz commands</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitusagecautions-li><input type=checkbox id=m-docshertztutorialstoolkitusagecautions-check>
<label for=m-docshertztutorialstoolkitusagecautions-check><a href=/docs/hertz/tutorials/toolkit/usage/cautions/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitusagecautions><span>note</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkittemplate-li><input type=checkbox id=m-docshertztutorialstoolkittemplate-check>
<label for=m-docshertztutorialstoolkittemplate-check><a href=/docs/hertz/tutorials/toolkit/template/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkittemplate><span>hz custom template use</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitplugin-li><input type=checkbox id=m-docshertztutorialstoolkitplugin-check>
<label for=m-docshertztutorialstoolkitplugin-check><a href=/docs/hertz/tutorials/toolkit/plugin/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitplugin><span>hz access plugin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkitclient-li><input type=checkbox id=m-docshertztutorialstoolkitclient-check>
<label for=m-docshertztutorialstoolkitclient-check><a href=/docs/hertz/tutorials/toolkit/client/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkitclient><span>hz client code generation</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzfaq-li><input type=checkbox id=m-docshertzfaq-check checked>
<label for=m-docshertzfaq-check><a href=/docs/hertz/faq/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzfaq><span>FAQ</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertzreference-li><input type=checkbox id=m-docshertzreference-check checked>
<label for=m-docshertzreference-check><a href=/docs/hertz/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzreference><span>Reference</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferenceconfig-li><input type=checkbox id=m-docshertzreferenceconfig-check>
<label for=m-docshertzreferenceconfig-check><a href=/docs/hertz/reference/config/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferenceconfig><span>Configuration instruction</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferenceversion-li><input type=checkbox id=m-docshertzreferenceversion-check>
<label for=m-docshertzreferenceversion-check><a href=/docs/hertz/reference/version/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferenceversion><span>Version Descriptions</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferencejson-li><input type=checkbox id=m-docshertzreferencejson-check>
<label for=m-docshertzreferencejson-check><a href=/docs/hertz/reference/json/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferencejson><span>JSON Marshal Library</span></a></label></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/cloudwego/cloudwego.github.io/edit/main/content/en/docs/hertz/tutorials/service-governance/service_discovery.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/new/main/content/en/docs/hertz/tutorials/service-governance/service_discovery.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/issues/new?title=Service%20Registration%20and%20Discovery" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/cloudwego/kitex/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#configuration>Configuration</a><ul><li><a href=#withsd>WithSD</a></li><li><a href=#withtag>WithTag</a></li><li><a href=#withcustomizedaddrs>WithCustomizedAddrs</a></li><li><a href=#withloadbalanceoptions>WithLoadBalanceOptions</a></li></ul></li><li><a href=#nacos>Nacos</a><ul><li><a href=#install>Install</a></li><li><a href=#service-registry>Service Registry</a></li><li><a href=#service-discovery>Service Discovery</a></li><li><a href=#how-to-use>How to use</a></li><li><a href=#configuration-1>Configuration</a></li><li><a href=#complete-example>Complete Example</a></li></ul></li><li><a href=#consul>Consul</a><ul><li><a href=#install-1>Install</a></li><li><a href=#service-registry-1>Service Registry</a></li><li><a href=#service-discovery-1>Service Discovery</a></li><li><a href=#how-to-use-1>How to use</a></li><li><a href=#configuration-2>Configuration</a></li><li><a href=#complete-example-1>Complete Example</a></li></ul></li><li><a href=#etcd>Etcd</a><ul><li><a href=#install-2>Install</a></li><li><a href=#service-registry-2>Service Registry</a></li><li><a href=#service-discovery-2>Service Discovery</a></li><li><a href=#how-to-use-2>How to use</a></li><li><a href=#configuration-3>Configuration</a></li><li><a href=#complete-example-2>Complete Example</a></li></ul></li><li><a href=#eureka>Eureka</a><ul><li><a href=#install-3>Install</a></li><li><a href=#service-registry-3>Service Registry</a></li><li><a href=#service-discovery-3>Service Discovery</a></li><li><a href=#how-to-use-3>How to use</a></li><li><a href=#configuration-4>Configuration</a></li><li><a href=#complete-example-3>Complete Example</a></li></ul></li><li><a href=#polaris>Polaris</a><ul><li><a href=#install-4>Install</a></li><li><a href=#service-registry-4>Service Registry</a></li><li><a href=#service-discovery-4>Service Discovery</a></li><li><a href=#how-to-use-4>How to use</a></li><li><a href=#configuration-5>Configuration</a></li><li><a href=#complete-example-4>Complete Example</a></li></ul></li><li><a href=#servicecomb>Servicecomb</a><ul><li><a href=#install-5>Install</a></li><li><a href=#service-registry-5>Service Registry</a></li><li><a href=#service-discovery-5>Service Discovery</a></li><li><a href=#how-to-use-5>How to use</a></li><li><a href=#configuration-6>Configuration</a></li><li><a href=#complete-example-5>Complete Example</a></li></ul></li><li><a href=#zookeeper>Zookeeper</a><ul><li><a href=#install-6>Install</a></li><li><a href=#service-registry-6>Service Registry</a></li><li><a href=#service-discovery-6>Service Discovery</a></li><li><a href=#how-to-use-6>How to use</a></li><li><a href=#configuration-7>Configuration</a></li><li><a href=#complete-example-6>Complete Example</a></li></ul></li><li><a href=#redis>Redis</a><ul><li><a href=#install-7>Install</a></li><li><a href=#service-registry-7>Service Registry</a></li><li><a href=#service-discovery-7>Service Discovery</a></li><li><a href=#how-to-use-7>How to use</a></li><li><a href=#configuration-8>Configuration</a></li><li><a href=#complete-example-7>Complete Example</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/>Hertz</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/tutorials/>Tutorials</a></li><li class=breadcrumb-item><a href=https://www.cloudwego.io/docs/hertz/tutorials/service-governance/>Service Governance</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://www.cloudwego.io/docs/hertz/tutorials/service-governance/service_discovery/>Service Registration and Discovery</a></li></ol></nav><div class=td-content><h1>Service Registration and Discovery</h1><header class=article-meta></header><p>The service discovery extensions currently supported in the open source version of Hertz are stored in the <a href=https://github.com/hertz-contrib/registry>registry</a>. You are welcomed to join us in contributing and maintaining for this project.</p><p>As of now, the supported service discovery extensions are</p><ul><li><a href=https://github.com/hertz-contrib/registry/tree/main/nacos>nacos</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/consul>consul</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/etcd>etcd</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/eureka>eureka</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/polaris>polaris</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/servicecomb>servicecomb</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/zookeeper>zookeeper</a></li><li><a href=https://github.com/hertz-contrib/registry/tree/main/redis>redis</a></li></ul><h2 id=configuration>Configuration</h2><p>Some optional configurations are provided to users when using service discovery.</p><table><thead><tr><th>Configuration</th><th>Description</th></tr></thead><tbody><tr><td>WithSD</td><td>Set isSD to true , <strong>required to use service discovery</strong>.</td></tr><tr><td>WithTag</td><td>Set tag for requestOptions.</td></tr><tr><td>WithCustomizedAddrs</td><td>Customize the address of the target instance.</td></tr><tr><td>WithLoadBalanceOptions</td><td>Configure load balancing options.</td></tr></tbody></table><h3 id=withsd>WithSD</h3><p><code>requestOptions</code> provides <code>WithSD</code> configuration item, when the incoming parameter is true, <code>isSD</code> will be set to true. The <code>WithSD</code> configuration item must be used when using service discovery requests.</p><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><h3 id=withtag>WithTag</h3><p><code>requestOptions</code> provides <code>WithTag</code> configuration item, using this configuration will set tag for <code>requestOptions</code>.</p><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTag</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;var&#34;</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><h3 id=withcustomizedaddrs>WithCustomizedAddrs</h3><p>This configuration item specifies the target instance address during service discovery. It will overwrite the result from <code>Resolver</code>. <code>Resolver</code> is a service discovery center for service discovery.</p><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithCustomizedAddrs</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:8088&#34;</span><span style=color:#000;font-weight:700>)))</span>
</code></pre></div><h3 id=withloadbalanceoptions>WithLoadBalanceOptions</h3><p>This configuration item can configure the load balancing algorithm and load balancing parameters for the client.</p><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithLoadBalanceOptions</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>loadbalance</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewWeightedBalancer</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#000>loadbalance</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Options</span><span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>RefreshInterval</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>5</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
     <span style=color:#000>ExpireInterval</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>15</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>})))</span>
</code></pre></div><h2 id=nacos>Nacos</h2><h3 id=install>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>nacos</span>
</code></pre></div><h3 id=service-registry>Service Registry</h3><h4 id=option>Option</h4><p>Nacos extension provides option configuration in the service registry section.</p><h5 id=withregistrycluster>WithRegistryCluster</h5><p>Nacos extension provides <code>WithRegistryCluster</code> to help users configure custom clusters. Defaults to &ldquo;DEFAULT&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryCluster</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cluster</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosRegistry</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryCluster</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Cluster123&#34;</span><span style=color:#000;font-weight:700>),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withregistrygroup>WithRegistryGroup</h5><p>Nacos extension provides <code>WithRegistryGroup</code> to help users configure custom clusters. Defaults to &ldquo;DEFAULT_GROUP&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryGroup</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>group</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosRegistry</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryGroup</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Group1&#34;</span><span style=color:#000;font-weight:700>),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newdefaultnacosregistry>NewDefaultNacosRegistry</h4><p><code>NewDefaultNacosRegistry</code> creates a default service registry using nacos. <code>NewDefaultNacosConfig</code> will be called to use the default client. By default, the RegionID is <code>cn-hangzhou</code>, the address is <code>127.0.0.1</code>, the port number is <code>8848</code>, and the cache will not be loaded at the beginning. Service registry configuration can be customized.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewDefaultNacosRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>RegistryOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosRegistry</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newnacosregistry>NewNacosRegistry</h4><p><code>NewNacosRegistry</code> uses nacos to create a service registry that can configure clients, and needs to pass in self-configured clients. Customizable service registry configuration.</p><p>Function signature：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewNacosRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>client</span> <span style=color:#000>naming_client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>INamingClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>RegistryOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span>
</code></pre></div><p>Example：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>clients</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNamingClient</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>vo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NacosClientParam</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ClientConfig</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>cc</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>ServerConfigs</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>sc</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>},</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNacosRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cli</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery>Service Discovery</h3><h4 id=option-1>Option</h4><p>Nacos extension provides option configuration in the service discovery section.</p><h5 id=withregistrycluster-1>WithRegistryCluster</h5><p>Nacos extension provides <code>WithRegistryCluster</code> to help users configure custom clusters. Defaults to &ldquo;DEFAULT&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryCluster</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cluster</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosResolver</span><span style=color:#000;font-weight:700>(</span>
    <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryCluster</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Cluster123&#34;</span><span style=color:#000;font-weight:700>),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withregistrygroup-1>WithRegistryGroup</h5><p>Nacos extension provides <code>WithRegistryGroup</code> to help users configure custom clusters. Defaults to &ldquo;DEFAULT_GROUP&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryGroup</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>group</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosResolver</span><span style=color:#000;font-weight:700>(</span>
    <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryGroup</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Group1&#34;</span><span style=color:#000;font-weight:700>),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newdefaultnacosresolver>NewDefaultNacosResolver</h4><p><code>NewDefaultNacosResolver</code> creates a default service discovery center using nacos. <code>NewDefaultNacosConfig</code> will be called to use the default client. By default, the RegionID is <code>cn-hangzhou</code>, the address is <code>127.0.0.1</code>, the port number is <code>8848</code>, and the cache will not be loaded at the beginning. Service registry configuration can be customized.</p><p>Function signature：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewDefaultNacosResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>ResolverOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosResolver</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newnacosresolver>NewNacosResolver</h4><p><code>NewNacosResolver</code> uses nacos to create a service discovery center with a configurable client, which needs to be passed in a self-configured client. Customizable Service Discovery Center configuration.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewNacosResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cli</span> <span style=color:#000>naming_client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>INamingClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>ResolverOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>nacosCli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>clients</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNamingClient</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>vo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NacosClientParam</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ClientConfig</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>cc</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>ServerConfigs</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>sc</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNacosResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>nacosCli</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use>How to use</h3><h4 id=server>Server</h4><ul><li>Use <code>server.WithRegistry</code> to set up registration extensions and registration information.</li></ul><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/nacos&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>addr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosRegistry</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client>Client</h4><ul><li>Use the <code>sd.Discovery</code> built-in middleware to support incoming custom service discovery extensions as well as load balance extensions.</li><li>When using service discovery, replace Host with the service name and use <code>config.WithSD</code> to confirm that this request uses service registration.</li></ul><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/nacos&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>nacos</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultNacosResolver</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;code=%d,body=%s\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-1>Configuration</h3><p>The configuration of Nacos client and server can be customized, refer to the configuration of <a href=https://github.com/nacos-group/nacos-sdk-go>nacos-sdk-go</a> .</p><h3 id=complete-example>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/nacos/examples>example</a> .</p><h2 id=consul>Consul</h2><h3 id=install-1>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>consul</span>
</code></pre></div><h3 id=service-registry-1>Service Registry</h3><h4 id=option-2>Option</h4><p>Consul extension provides option configuration in the service registry section.</p><h5 id=withregistrygroup-2>WithRegistryGroup</h5><p>Consul extension provides <code>WithCheck</code> to help users configure the <code>AgentServiceCheck</code> option in Consul. <code>defaultCheck()</code> is called by default.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithCheck</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>check</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>api</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgentServiceCheck</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>check</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgentServiceCheck</span><span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewConsulRegister</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithCheck</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>check</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newconsulregister>NewConsulRegister</h4><p><code>NewConsulRegister</code> uses consul to create a new service registry, which needs to be passed in a client, which is created with <code>NewClient</code>. The service registry configuration can be customized. If no configuration is passed in, set <code>check.Timeout</code> to 5 seconds, <code>check.Internal</code> to 5 seconds, and <code>check.DeregisterCriticalServiceAfter</code> to 1 minute.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewConsulRegister</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>api</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewConsulRegister</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-1>Service Discovery</h3><h4 id=option-3>Option</h4><p>Consul extension provides option configuration in the service discovery section.</p><h5 id=withregistrygroup-3>WithRegistryGroup</h5><p>Consul extension provides <code>WithCheck</code> to help users configure the <code>AgentServiceCheck</code> option in Consul. <code>defaultCheck()</code> is called by default.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithCheck</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>check</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>api</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgentServiceCheck</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulConfig</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>check</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>AgentServiceCheck</span><span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewConsulResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithCheck</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>check</span><span style=color:#000;font-weight:700>))</span>

    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newconsulresolver>NewConsulResolver</h4><p><code>NewConsulResolver</code> uses consul to create a new service discovery center, you need to pass in the client. The client is created using <code>NewClient</code>. The service discovery center configuration can be customized.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewConsulResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>api</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulConfig</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewConsulResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-1>How to use</h3><h4 id=server-1>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#000>consulapi</span> <span style=color:#4e9a06>&#34;github.com/hashicorp/consul/api&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/consul&#34;</span>
<span style=color:#000;font-weight:700>)</span>


<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// build a consul client
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>config</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DefaultConfig</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Address</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8500&#34;</span>
    <span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// build a consul register with the consul client
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewConsulRegister</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#8f5902;font-style:italic>// run Hertz with the consul register
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>addr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong1&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-1>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#000>consulapi</span> <span style=color:#4e9a06>&#34;github.com/hashicorp/consul/api&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/consul&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// build a consul client
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>consulConfig</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>DefaultConfig</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>consulConfig</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Address</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8500&#34;</span>
    <span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consulapi</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulConfig</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// build a consul resolver with the consul client
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>consul</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewConsulResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consulClient</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#8f5902;font-style:italic>// build a hertz client with the consul resolver
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-2>Configuration</h3><p>The configuration of Consul client and server can be customized, refer to the configuration of <a href=https://github.com/hashicorp/consul>consul</a>.</p><h3 id=complete-example-1>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/consul/example>example</a> .</p><h2 id=etcd>Etcd</h2><h3 id=install-2>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>etcd</span>
</code></pre></div><h3 id=service-registry-2>Service Registry</h3><h4 id=option-4>Option</h4><p>Etcd extension provides option configuration in the service registry section.</p><h5 id=withtlsopt>WithTLSOpt</h5><p>Etcd extension provides <code>WithTLSOpt</code> to help users configure an option to authenticate via tls/ssl.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithTLSOpt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>certFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>keyFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>caFile</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEtcdRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2379&#34;</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTLSOpt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>certFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>keyFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>caFile</span><span style=color:#000;font-weight:700>),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newetcdregistry>NewEtcdRegistry</h4><p><code>NewEtcdRegistry</code> uses etcd to create a new service registry, requires passing in the endpoint value. Customizable client configuration and passing in <code>New</code> creates a new client. Customizable service registry configuration.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEtcdRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>endpoints</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEtcdRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2379&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-2>Service Discovery</h3><h4 id=option-5>Option</h4><p>Etcd extension provides option configuration in the service discovery section.</p><h5 id=withtlsopt-1>WithTLSOpt</h5><p>Etcd extension provides <code>WithTLSOpt</code> to help users configure an option to authenticate via tls/ssl.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithTLSOpt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>certFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>keyFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>caFile</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEtcdRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2379&#34;</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTLSOpt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>certFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>keyFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>caFile</span><span style=color:#000;font-weight:700>),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newetcdresolver>NewEtcdResolver</h4><p><code>NewEtcdResolver</code> uses etcd to create a new service discovery center, needs to pass in the endpoint value. You can customize the client configuration and pass <code>New</code> to create a new client. Customize the service discovery center configuration.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEtcdResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>endpoints</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEtcdResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2379&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-2>How to use</h3><h4 id=server-2>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/etcd&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEtcdRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2379&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>addr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>_</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong2&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-2>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/etcd&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>etcd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEtcdResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2379&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;HERTZ: code=%d,body=%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-3>Configuration</h3><p>The configuration of Etcd client and server can be customized, refer to the configuration of <a href=https://pkg.go.dev/go.etcd.io/etcd/client/v3>etcd-client</a>.</p><h3 id=complete-example-2>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/etcd/example>example</a> .</p><h2 id=eureka>Eureka</h2><h3 id=install-3>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>eureka</span>
</code></pre></div><h3 id=service-registry-3>Service Registry</h3><h4 id=neweurekaregistry>NewEurekaRegistry</h4><p><code>NewEurekaRegistry</code> uses eureka to create a new service registry, you need to pass the service Url into <code>NewConn</code> through a string slice, and also pass in the heartbeat interval.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEurekaRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>servers</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>heatBeatInterval</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>eurekaRegistry</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;http://127.0.0.1:8761/eureka&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.discovery.eureka&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=neweurekaregistryfromconfig>NewEurekaRegistryFromConfig</h4><p><code>NewEurekaRegistryFromConfig</code> uses eureka to create a new service registry, you need to pass in the configuration and call <code>NewConnFromConfig</code> , and also need to pass in the heartbeat interval.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEurekaRegistryFromConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>heatBeatInterval</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>eurekaRegistry</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>config</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaRegistryFromConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.discovery.eureka&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=neweurekaregistryfromconn>NewEurekaRegistryFromConn</h4><p><code>NewEurekaRegistryFromConn</code> uses eureka to create a new service registry, you need to pass in conn directly, and also need to pass in the heartbeat interval.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEurekaRegistryFromConn</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EurekaConnection</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>heatBeatInterval</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>eurekaRegistry</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>conn</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EurekaConnection</span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaRegistryFromConn</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.discovery.eureka&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-3>Service Discovery</h3><h4 id=neweurekaresolver>NewEurekaResolver</h4><p><code>NewEurekaResolver</code> uses eureka to create a new service discovery center, you need to pass the service Url through a string slice to <code>NewConn</code>.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEurekaResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>servers</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>eurekaResolver</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;http://127.0.0.1:8761/eureka&#34;</span><span style=color:#000;font-weight:700>})</span>

    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=neweurekaresolverfromconfig>NewEurekaResolverFromConfig</h4><p><code>NewEurekaResolverFromConfig</code> uses eureka to create a new service discovery center, requires passing in the configuration and calling <code>NewConnFromConfig</code>.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEurekaResolverFromConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>eurekaResolver</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>config</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaResolverFromConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=neweurekaresolverfromconn>NewEurekaResolverFromConn</h4><p><code>NewEurekaResolverFromConn</code> uses eureka to create a new service discovery center, which needs to be passed directly to conn.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewEurekaResolverFromConn</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EurekaConnection</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>eurekaResolver</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>conn</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>fargo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>EurekaConnection</span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaResolverFromConn</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>conn</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-3>How to use</h3><h4 id=server-3>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;time&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/eureka&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>addr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;http://127.0.0.1:8761/eureka&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.discovery.eureka&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong2&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-3>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/eureka&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>eureka</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewEurekaResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;http://127.0.0.1:8761/eureka&#34;</span><span style=color:#000;font-weight:700>})</span>

    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.discovery.eureka/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;code=%d,body=%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-4>Configuration</h3><p>This project uses <a href=https://github.com/hudl/fargo>fargo</a> as eureka client. You should refer to <a href=https://github.com/hudl/fargo>fargo</a> documentation for advanced configuration.</p><h3 id=complete-example-3>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/eureka/example>example</a> .</p><h2 id=polaris>Polaris</h2><h3 id=install-4>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>polaris</span>
</code></pre></div><h3 id=service-registry-4>Service Registry</h3><h4 id=newpolarisregistry>NewPolarisRegistry</h4><p><code>NewPolarisRegistry</code> creates a new service registry using polaris, passing in a configuration file and calling <code>GetPolarisConfig</code> , using the default configuration if not passed in.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewPolarisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>configFile</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>Registry</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>polaris</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewPolarisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>confPath</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>Info</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#4e9a06>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>Namespace</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>},</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Info</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithExitWaitTime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-4>Service Discovery</h3><h4 id=newpolarisresolver>NewPolarisResolver</h4><p><code>NewPolarisResolver</code> uses polaris to create a new service discovery center, passing in a configuration file and calling <code>GetPolarisConfig</code> , using the default configuration if not passed in.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewPolarisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>configFile</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>Resolver</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>polaris</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewPolarisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>confPath</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>hclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-4>How to use</h3><h4 id=server-4>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>
    <span style=color:#4e9a06>&#34;time&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/polaris&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#000>confPath</span>  <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;polaris.yaml&#34;</span>
    <span style=color:#000>Namespace</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Polaris&#34;</span>
    <span style=color:#8f5902;font-style:italic>// At present,polaris server tag is v1.4.0，can&#39;t support auto create namespace,
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// If you want to use a namespace other than default,Polaris ,before you register an instance,
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// you should create the namespace at polaris console first.
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>polaris</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewPolarisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>confPath</span><span style=color:#000;font-weight:700>)</span>

    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>Info</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#4e9a06>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>Namespace</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>},</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Info</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithExitWaitTime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>))</span>

    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Hello,Hertz!&#34;</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>})</span>

    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-4>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>

    <span style=color:#000>hclient</span> <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/polaris&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#000>confPath</span>  <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;polaris.yaml&#34;</span>
    <span style=color:#000>Namespace</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Polaris&#34;</span>
    <span style=color:#8f5902;font-style:italic>// At present,polaris server tag is v1.4.0，can&#39;t support auto create namespace,
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// if you want to use a namespace other than default,Polaris ,before you register an instance,
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// you should create the namespace at polaris console first.
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>polaris</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewPolarisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>confPath</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>hclient</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>

    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// config.WithTag sets the namespace tag for service discovery
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TODO</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTag</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;namespace&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Namespace</span><span style=color:#000;font-weight:700>))</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;code=%d,body=%s\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-5>Configuration</h3><p>The configuration of Polaris client and server can be customized, refer to the configuration of <a href=https://pkg.go.dev/github.com/polarismesh/polaris-go/api#section-readme>polaris-go</a>.</p><h3 id=complete-example-4>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/polaris/example>example</a> .</p><h2 id=servicecomb>Servicecomb</h2><h3 id=install-5>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>servicecomb</span>
</code></pre></div><h3 id=service-registry-5>Service Registry</h3><h4 id=option-6>Option</h4><p>Servicecomb extension provides option configuration in the service registry section.</p><h5 id=withappid>WithAppId</h5><p>Servicecomb extension provides <code>WithAppId</code> to help users configure the AppId of Servicecomb. Defaults to &ldquo;DEFAULT&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithAppId</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>appId</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithAppId</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;appID&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withregistryversionrule>WithRegistryVersionRule</h5><p>Servicecomb extension provides <code>WithRegistryVersionRule</code> to help users configure the version requirements of Servicecomb. Defaults to 1.0.0 .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryVersionRule</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>versionRule</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryVersionRule</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.1.0&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withregistryhostname>WithRegistryHostName</h5><p>Servicecomb extension provides <code>WithRegistryHostName</code> to help users configure Servicecomb&rsquo;s hostname. Defaults to &ldquo;DEFAULT&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryHostName</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hostName</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryHostName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;hostName&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withregistryheartbeatinterval>WithRegistryHeartbeatInterval</h5><p>Servicecomb extension provides <code>WithRegistryHeartbeatInterval</code> to help users configure the interval for sending heartbeat packets. Default is 5.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithRegistryHeartbeatInterval</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>second</span> <span style=color:#204a87;font-weight:700>int32</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>RegistryOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistryHeartbeatInterval</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newdefaultscregistry>NewDefaultSCRegistry</h4><p><code>NewDefaultSCRegistry</code> uses service-comb to create a default service registry, which needs to pass in the endpoint value. The service registry configuration can be customized.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>endPoints</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>RegistryOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newscregistry>NewSCRegistry</h4><p><code>NewSCRegistry</code> uses service-comb to create a new service registry. It needs to pass in a custom client. Customizable service registry configuration.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewSCRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>sc</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>RegistryOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>sc</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewSCRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-5>Service Discovery</h3><h4 id=option-7>Option</h4><p>Servicecomb extension provides option configuration in the service discovery section.</p><h5 id=withappid-1>WithAppId</h5><p>Servicecomb extension provides <code>WithAppId</code> to help users configure the AppId of Servicecomb. Defaults to &ldquo;DEFAULT&rdquo; .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithResolverAppId</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>appId</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>ResolverOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithAppId</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;appID&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withresolverversionrule>WithResolverVersionRule</h5><p>Servicecomb extension provides <code>WithResolverVersionRule</code> to help users configure Servicecomb&rsquo;s version requirements. Defaults to latest .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithResolverVersionRule</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>versionRule</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>ResolverOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithResolverVersionRule</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;1.0.0&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withresolverconsumerid>WithResolverConsumerId</h5><p>Servicecomb extension provides <code>WithResolverConsumerId</code> to help users configure Servicecomb&rsquo;s ConsumerId . Default is empty .</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithResolverConsumerId</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consumerId</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>ResolverOption</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>},</span>
        <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithResolverConsumerId</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newdefaultscresolver>NewDefaultSCResolver</h4><p><code>NewDefaultSCResolver</code> uses service-comb to create a default service discovery center, which needs to pass in the endpoint value. Service discovery center configuration can be customized.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewDefaultSCResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>endPoints</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>ResolverOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newscresolver>NewSCResolver</h4><p><code>NewSCReslover</code> uses service-comb to create a new service discovery center. It needs to pass in a custom client. The configuration of the service discovery center can be customized.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewSCResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>cli</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>sc</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>ResolverOption</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>client</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>sc</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Client</span><span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewSCResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>client</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-5>How to use</h3><h4 id=server-5>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;log&#34;</span>
    <span style=color:#4e9a06>&#34;sync&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/servicecomb&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>scAddr</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:30100&#34;</span>
    <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>addr</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8701&#34;</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.servicecomb.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>

    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong1&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-5>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/servicecomb&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>scAddr</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;127.0.0.1:30100&#34;</span>
    <span style=color:#8f5902;font-style:italic>// build a servicecomb resolver
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>servicecomb</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewDefaultSCResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>scAddr</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic>// build a hertz client with the servicecomb resolver
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.servicecomb.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;code=%d,body=%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-6>Configuration</h3><p>The configuration of Servicecomb client and server can be customized, refer to the configuration of <a href=https://github.com/go-chassis/sc-client>go-chassis/sc-client</a>.</p><h3 id=complete-example-5>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/servicecomb/example>example</a> .</p><h2 id=zookeeper>Zookeeper</h2><h3 id=install-6>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>zookeeper</span>
</code></pre></div><h3 id=service-registry-6>Service Registry</h3><h4 id=newzookeeperregistry>NewZookeeperRegistry</h4><p><code>NewZookeeperRegistry</code> uses zookeeper to create a service registry. You need to pass the service to <code>Connect</code> through a string slice together with the session timeout.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewZookeeperRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>servers</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sessionTimeout</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>zookeeper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewZookeeperRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2181&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newzookeeperregistrywithauth>NewZookeeperRegistryWithAuth</h4><p><code>NewZookeeperRegistryWithAuth</code> uses zookeeper to create a service registry. You need to pass the service into <code>Connect</code> through a string slice and session timeout time. In addition, you need to pass in the user and password to call <code>AddAuth</code>, the user and password Can not be empty.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewZookeeperRegistryWithAuth</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>servers</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sessionTimeout</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>user</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>password</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>zookeeper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewZookeeperRegistryWithAuth</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2181&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>20</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;hertzuser&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;hertzpass&#34;</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-6>Service Discovery</h3><h4 id=newzookeeperresolver>NewZookeeperResolver</h4><p><code>NewZookeeperResolver</code> uses zookeeper to create a service discovery center, which needs to pass a string slice and session timeout to <code>Connect</code>.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewZookeeperResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>servers</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sessionTimeout</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>zookeeper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewZookeeperResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2181&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newzookeeperresolverwithauth>NewZookeeperResolverWithAuth</h4><p><code>NewZookeeperResolverWithAuth</code> uses zookeeper to create a service discovery center. You need to pass the service into <code>Connect</code> through a string slice and session timeout. In addition, you need to pass in the user and password to call <code>AddAuth</code>, the user and password Can not be empty.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewZookeeperResolverWithAuth</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>servers</span> <span style=color:#000;font-weight:700>[]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>sessionTimeout</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>user</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>password</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>Example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>zookeeper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewZookeeperResolverWithAuth</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2181&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;hertzuser&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;hertzpass&#34;</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-6>How to use</h3><h4 id=server-6>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;time&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/zookeeper&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>addr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>zookeeper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewZookeeperRegistry</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2181&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}))</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>c</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong2&#34;</span><span style=color:#000;font-weight:700>})</span>
    <span style=color:#000;font-weight:700>})</span>
    <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-6>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
    <span style=color:#4e9a06>&#34;context&#34;</span>
    <span style=color:#4e9a06>&#34;time&#34;</span>

    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
    <span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/zookeeper&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>zookeeper</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewZookeeperResolver</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;127.0.0.1:2181&#34;</span><span style=color:#000;font-weight:700>},</span> <span style=color:#0000cf;font-weight:700>40</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;code=%d,body=%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-7>Configuration</h3><p>The configuration of Zookeeper client and server can be customized, refer to the configuration of <a href=https://github.com/go-zookeeper/zk>go-zookeeper/zk</a>.</p><h3 id=complete-example-6>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/zookeeper/example>example</a> .</p><h2 id=redis>Redis</h2><h3 id=install-7>Install</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>go</span> <span style=color:#000>get</span> <span style=color:#000>github</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>com</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>hertz</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>contrib</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>registry</span><span style=color:#ce5c00;font-weight:700>/</span><span style=color:#000>redis</span>
</code></pre></div><h3 id=service-registry-7>Service Registry</h3><h4 id=option-8>Option</h4><p>The Redis extension provides option configuration in the service registry section.</p><h5 id=withpassword>WithPassword</h5><p>The Redis extension provides <code>WithPassword</code> to configure the redis password, which must match the password specified in the server configuration options.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithPassword</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>password</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithPassword</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;123456&#34;</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
     <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
     <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
       <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
       <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
       <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
       <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
     <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withdb>WithDB</h5><p>The Redis extension provides <code>WithDB</code> to configure the database to choose after connecting to the server.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithDB</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>db</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithDB</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
             <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
         <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withtlsconfig>WithTLSConfig</h5><p>The Redis extension provides <code>WithTLSConfig</code> configuration items for configuring TLS.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithTLSConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>tls</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTLSConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>tls</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>{</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000;font-weight:700>}))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
             <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
         <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withdialer>WithDialer</h5><p>The Redis extension provides <code>WithDialer</code> to configure Dialer, Dialer will create a new network connection and take precedence over Network and Addr options.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithDialer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dialer</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>network</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithDialer</span><span style=color:#000;font-weight:700>(</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
             <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
         <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withreadtimeout>WithReadTimeout</h5><p>The Redis extension provides <code>WithReadTimeout</code> to configure the read socket timeout time, the default is 3 seconds.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithReadTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithReadTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
             <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
         <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withwritetimeout>WithWriteTimeout</h5><p>The Redis extension provides <code>WithWriteTimeout</code> to configure the write socket timeout time, the default is equivalent to <code>ReadTimeout</code>.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithWriteTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithWriteTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>))</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
        <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
            <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
            <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
            <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
        <span style=color:#000;font-weight:700>}),</span>
    <span style=color:#000;font-weight:700>)</span>
    <span style=color:#8f5902;font-style:italic>// ...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newredisregistry>NewRedisRegistry</h4><p><code>NewRedisRegistry</code> uses redis to create a new service registry and needs to pass in the target address. You can customize the client configuration and pass in <code>NewClient</code> to create a new client.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Registry</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
             <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
         <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=service-discovery-7>Service Discovery</h3><h4 id=option-9>Option</h4><p>Redis extension provides option configuration in the service discovery section.</p><h5 id=withpassword-1>WithPassword</h5><p>The Redis extension provides <code>WithPassword</code> to configure the redis password, which must match the password specified in the server configuration options.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithPassword</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>password</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithPassword</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;123456&#34;</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withdb-1>WithDB</h5><p>The Redis extension provides <code>WithDB</code> to configure the database to choose after connecting to the server.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithDB</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>db</span> <span style=color:#204a87;font-weight:700>int</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithDB</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withtlsconfig-1>WithTLSConfig</h5><p>The Redis extension provides <code>WithTLSConfig</code> configuration items for configuring TLS.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithTLSConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>tls</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTLSConfig</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>tls</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span><span style=color:#000;font-weight:700>{</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000;font-weight:700>}))</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withdialer-1>WithDialer</h5><p>The Redis extension provides <code>WithDialer</code> to configure Dialer, Dialer will create a new network connection and take precedence over Network and Addr options.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithDialer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>dialer</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>network</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithDialer</span><span style=color:#000;font-weight:700>(</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000;font-weight:700>))</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withreadtimeout-1>WithReadTimeout</h5><p>The Redis extension provides <code>WithReadTimeout</code> to configure the read socket timeout time, the default is 3 seconds.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithReadTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithReadTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000;font-weight:700>))</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h5 id=withwritetimeout-1>WithWriteTimeout</h5><p>The Redis extension provides <code>WithWriteTimeout</code> to configure the write socket timeout time, the default is equivalent to <code>ReadTimeout</code>.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>WithWriteTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>t</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>Option</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithWriteTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000;font-weight:700>))</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=newredisresolver>NewRedisResolver</h4><p><code>NewRedisResolver</code> uses redis to create a new service discovery center, and needs to pass in the target address. You can customize the client configuration and pass in <code>NewClient</code> to create a new client.</p><p>Function signature:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewRedisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>opts</span> <span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000>Option</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>discovery</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resolver</span>
</code></pre></div><p>Sample code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span>     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>)</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#8f5902;font-style:italic>//...
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=how-to-use-7>How to use</h3><h4 id=server-7>Server</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
<span style=color:#4e9a06>&#34;context&#34;</span>

<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/server/registry&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/utils&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/protocol/consts&#34;</span>
<span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/redis&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>)</span>
     <span style=color:#000>addr</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;127.0.0.1:8888&#34;</span>
     <span style=color:#000>h</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Default</span><span style=color:#000;font-weight:700>(</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithHostPorts</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
         <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithRegistry</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>registry</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Info</span><span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>ServiceName</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;hertz.test.demo&#34;</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewNetAddr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;tcp&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>),</span>
             <span style=color:#000>Weight</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>,</span>
             <span style=color:#000>Tags</span><span style=color:#000;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span>
         <span style=color:#000;font-weight:700>}),</span>
     <span style=color:#000;font-weight:700>)</span>
     <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>GET</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>_</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ctx</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
         <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>consts</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusOK</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>utils</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>H</span><span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;ping&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;pong&#34;</span><span style=color:#000;font-weight:700>})</span>
     <span style=color:#000;font-weight:700>})</span>
     <span style=color:#000>h</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Spin</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h4 id=client-7>Client</h4><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>main</span>

<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000;font-weight:700>(</span>
<span style=color:#4e9a06>&#34;context&#34;</span>

<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/client&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/app/middlewares/client/sd&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/config&#34;</span>
<span style=color:#4e9a06>&#34;github.com/cloudwego/hertz/pkg/common/hlog&#34;</span>
<span style=color:#4e9a06>&#34;github.com/hertz-contrib/registry/redis&#34;</span>
<span style=color:#000;font-weight:700>)</span>

<span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>client</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>NewClient</span><span style=color:#000;font-weight:700>()</span>
     <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
         <span style=color:#204a87>panic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
     <span style=color:#000;font-weight:700>}</span>
     <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>redis</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewRedisResolver</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1:6379&#34;</span><span style=color:#000;font-weight:700>)</span>
     <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Use</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sd</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Discovery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>10</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span> <span style=color:#000;font-weight:700>{</span>
         <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>cli</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#204a87;font-weight:700>nil</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;http://hertz.test.demo/ping&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithSD</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>))</span>
         <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
             <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span> <span style=color:#000>Fatal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
         <span style=color:#000;font-weight:700>}</span>
         <span style=color:#000>hlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Infof</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;HERTZ: code=%d, body=%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>status</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>string</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>))</span>
     <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=configuration-8>Configuration</h3><p>You can customize the configuration of redis client and server, refer to <a href=https://github.com/go-redis/redis>go-redis</a> configuration.</p><h3 id=complete-example-7>Complete Example</h3><p>For more, see <a href=https://github.com/hertz-contrib/registry/tree/main/redis/example>example</a>.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector('.feedback--answer-yes'),noButton=document.querySelector('.feedback--answer-no'),yesResponse=document.querySelector('.feedback--response-yes'),noResponse=document.querySelector('.feedback--response-no'),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=b=>{if(typeof ga!='function')return;const a={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:b};ga(a.command,a.hitType,a.category,a.action,a.label,a.value)};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(1)}),noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified
April 13, 2023
: <a href=https://github.com/cloudwego/cloudwego.github.io/commit/a544e378411d253b2ed95a2c66f2a4eb0e0e5097>chore: fix link error (#603) (a544e37)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Lark aria-label=Lark><a class=text-white target=_blank rel=noopener href="https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=693v2544-2664-4421-b50f-7f1912p745r6" aria-label=Lark><img src=/webfonts/lark.svg alt style=width:26px;line-height:32.5px;margin-bottom:6px></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/CloudWeGo aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/cloudwego aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://join.slack.com/t/cloudwego/shared_invite/zt-tmcbzewn-UjXMF3ZQsPhl7W3tEDZboA aria-label=Slack><i class="fab fa-slack"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 The CloudWeGo Authors</small><p class="mt-2 text-white"><a class=cloudwego-link href=/about/ target=_blank rel=noopener>About</a>
|
<a class=cloudwego-link href=https://github.com/cloudwego/cloudwego.github.io/blob/main/LICENSE target=_blank rel=noopener>License</a></p></div></div></div></footer></div><script src=https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.staticfile.org/bootstrap/4.6.0/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/main.min.99d7cb67f0709dcc1d3641652a2142e6cb2272c12553893cdfffb8a69c5fda51.js integrity="sha256-mdfLZ/BwncwdNkFlKiFC5ssicsElU4k83/+4ppxf2lE=" crossorigin=anonymous></script><script src=/js/prism.js></script><script src=/js/docsearch.js></script><script type=text/javascript>let siteLang=window.location.pathname.startsWith('/zh/')?'zh':'en';docsearch({appId:'V7I042F992',apiKey:'8380a7ac88106841cb43fb000fa2edb4',indexName:'cloudwego',container:'#docsearch',searchParameters:{hitsPerPage:5,facetFilters:[`lang:${siteLang}`]}})</script><script src=/js/outbound-link.js></script><script src=/js/navScroll.js></script></body></html>